<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Week 10 Lab: Visualizing and Exploring Cross-Sectional Data in Tableau</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="lab_02_week_02_files/libs/clipboard/clipboard.min.js"></script>
<script src="lab_02_week_02_files/libs/quarto-html/quarto.js"></script>
<script src="lab_02_week_02_files/libs/quarto-html/popper.min.js"></script>
<script src="lab_02_week_02_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="lab_02_week_02_files/libs/quarto-html/anchor.min.js"></script>
<link href="lab_02_week_02_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lab_02_week_02_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="lab_02_week_02_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="lab_02_week_02_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="lab_02_week_02_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#learning-objectives-tableau" id="toc-learning-objectives-tableau" class="nav-link active" data-scroll-target="#learning-objectives-tableau">Learning Objectives Tableau</a></li>
  <li><a href="#geocoding-overview" id="toc-geocoding-overview" class="nav-link" data-scroll-target="#geocoding-overview">Geocoding Overview</a>
  <ul class="collapse">
  <li><a href="#tableaus-geocoding" id="toc-tableaus-geocoding" class="nav-link" data-scroll-target="#tableaus-geocoding">Tableau’s Geocoding</a></li>
  <li><a href="#tableaus-spatial-data-capabilities" id="toc-tableaus-spatial-data-capabilities" class="nav-link" data-scroll-target="#tableaus-spatial-data-capabilities">Tableau’s Spatial Data Capabilities</a></li>
  <li><a href="#symbol-vs.-filled-maps" id="toc-symbol-vs.-filled-maps" class="nav-link" data-scroll-target="#symbol-vs.-filled-maps">Symbol vs.&nbsp;Filled Maps</a>
  <ul class="collapse">
  <li><a href="#symbol-maps" id="toc-symbol-maps" class="nav-link" data-scroll-target="#symbol-maps">Symbol Maps</a></li>
  <li><a href="#filled-maps" id="toc-filled-maps" class="nav-link" data-scroll-target="#filled-maps">Filled Maps</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#geocoding-application" id="toc-geocoding-application" class="nav-link" data-scroll-target="#geocoding-application">Geocoding Application</a>
  <ul class="collapse">
  <li><a href="#creating-a-symbol-map" id="toc-creating-a-symbol-map" class="nav-link" data-scroll-target="#creating-a-symbol-map">1. Creating a Symbol Map</a></li>
  <li><a href="#creating-a-filled-map" id="toc-creating-a-filled-map" class="nav-link" data-scroll-target="#creating-a-filled-map">2. Creating a Filled Map</a></li>
  <li><a href="#customizing-your-map" id="toc-customizing-your-map" class="nav-link" data-scroll-target="#customizing-your-map">3. Customizing Your Map</a></li>
  <li><a href="#plotting-results-from-a-cluster-analysis" id="toc-plotting-results-from-a-cluster-analysis" class="nav-link" data-scroll-target="#plotting-results-from-a-cluster-analysis">4. Plotting Results from a Cluster Analysis</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Week 10 Lab: Visualizing and Exploring Cross-Sectional Data in Tableau</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><img src="includes/cross-sectional.png" class="img-fluid"></p>
<div style="font-size: 1.5em">
<p>This Lab Contributes to Course Objectives: 1, 3, 4, 5, 7, 8</p>
</div>
<section id="learning-objectives-tableau" class="level2">
<h2 class="anchored" data-anchor-id="learning-objectives-tableau">Learning Objectives Tableau</h2>
<ul>
<li><p>Understand Tableau geocoding capabilities</p></li>
<li><p>Explain the different use cases of symbol and filled maps</p></li>
<li><p>Create symbol and filled maps</p></li>
<li><p>Customize Tableau maps</p></li>
<li><p>Aggregate individual-level data by geographic region</p></li>
</ul>
</section>
<section id="geocoding-overview" class="level1">
<h1>Geocoding Overview</h1>
<p>The defining characteristic of cross-sectional data is that we observe values of variables at a single point in, or cross-section of time. Often, but not always, cross-sectional data have geographic components that allows us to use Tableau’s mapping features when creating visualizations. Effective analysis of cross-sectional data begins with estimating and conveying useful summary statistics. Today, we will spend most of our time discussing how to do this with spatial data.</p>
<section id="tableaus-geocoding" class="level2">
<h2 class="anchored" data-anchor-id="tableaus-geocoding">Tableau’s Geocoding</h2>
<p>If you want to analyze your data geographically, you can plot your data on a map in Tableau.</p>
<p>When building map views, Tableau supports any latitude and longitude coordinates, as long as they are in decimal degrees. Tableau can also recognize and geocode the following geographic information types:</p>
<ul>
<li><p>Airport Codes</p></li>
<li><p>Cities</p></li>
<li><p>Countries</p></li>
<li><p>Regions</p></li>
<li><p>Territories</p></li>
<li><p>States</p></li>
<li><p>Provinces</p></li>
<li><p>Postcodes</p></li>
<li><p>Core Based Statistical Areas (CBSAs)</p></li>
<li><p>Metropolitan Statistical Areas (MSAs)</p></li>
<li><p>U.S. Area Codes</p></li>
<li><p>Congressional Districts</p></li>
<li><p>Zip Codes</p></li>
</ul>
<p>If you have geographic delineations besides these, you will have to use crosswalks or some other means to convert the delineations to one of these forms, or to generate latitudes and longitudes for specific points (e.g., addresses).</p>
</section>
<section id="tableaus-spatial-data-capabilities" class="level2">
<h2 class="anchored" data-anchor-id="tableaus-spatial-data-capabilities">Tableau’s Spatial Data Capabilities</h2>
<p>Tableau can also connect to the following spatial file types:</p>
<ul>
<li><p>Shapefiles</p></li>
<li><p>KML files</p></li>
<li><p>GeoJSON files</p></li>
<li><p>TopoJSON files</p></li>
<li><p>Esri File Geodatabases</p></li>
</ul>
<p>These types of files include detailed geographic information that enables us to plot shapes and single points.</p>
</section>
<section id="symbol-vs.-filled-maps" class="level2">
<h2 class="anchored" data-anchor-id="symbol-vs.-filled-maps">Symbol vs.&nbsp;Filled Maps</h2>
<section id="symbol-maps" class="level3">
<h3 class="anchored" data-anchor-id="symbol-maps">Symbol Maps</h3>
<p>A symbol map is effective for showing quantitative data for individual locations. For example, you can use a symbol map to show individual store locations on a map.</p>
<p><img src="includes/Sheet1.png" class="img-fluid"></p>
<p>You might want to highlight which stores have <a href="https://www.safegraph.com/data-examples/ohio-grocery-spend">higher spending</a></p>
<p>To create a symbol map, be sure your data source includes the following types of information:</p>
<ul>
<li><p>Quantitative values</p></li>
<li><p>Latitude and longitude coordinates or geographic locations recognized by Tableau</p></li>
</ul>
<p>Symbol maps work best with data containing large variations of values. Without enough variation, the symbols will appear approximately the same size in the view.</p>
</section>
<section id="filled-maps" class="level3">
<h3 class="anchored" data-anchor-id="filled-maps">Filled Maps</h3>
<p>A filled map (or choropleth) can be effective when you want to compare values across space. For example, if you wanted to see relative rental rates across Colorado counties, you could use a filled map to show spatial comparisons.</p>
<p><img src="includes/Sheet3.png" class="img-fluid"></p>
<p>To create a filled map, verify that your data source includes the following types of information:</p>
<ul>
<li><p>Quantitative or qualitative values</p></li>
<li><p>Geographic locations recognized by Tableau or custom polygons (from a spatial data file)</p></li>
</ul>
<p><strong>Knowledge Check 1:</strong> Suppose we have county-level data on average gas prices last year. What type of map would you use to show this information?</p>
<p><strong>Knowledge Check 2:</strong> Suppose we have gas station-level data on gas prices yesterday. What type of map would you use to show this information?</p>
</section>
</section>
</section>
<section id="geocoding-application" class="level1">
<h1>Geocoding Application</h1>
<section id="creating-a-symbol-map" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-symbol-map">1. Creating a Symbol Map</h2>
<p>Connect to the dataset <code>arizona_grocery_foot_traffic.csv</code>. This is a very very VERY small slice of cell phone visit data from the company <a href="https://www.safegraph.com">Safegraph</a>. The slice includes all grocery retail stores in Arizona with a sufficiently large number of visitors in September of 2021. Visitors (including you if you happened to be in Arizona at that time…) are tracked via their cell phones. The data includes information on the store (name, location, NAICS code, etc.), the number of visits, visitors (unique cell phones), the median distance travelled to shop there, and the median amount of time spent there.</p>
<p>Let’s create a symbol map using the provided latitudes and longitudes of these stores.</p>
<ol type="1">
<li><p>Drag <code>Longitude</code> to the Columns Shelf and <code>Latitude</code> to the Rows Shelf. (You will likely have to change these fields to <code>Dimensions</code>)</p></li>
<li><p>Drag <code>Top Category</code> (this is the top sales category/type of each store) to the colors card.</p></li>
</ol>
<p>Which type of store appears to be the most prevalent?</p>
<ol start="3" type="1">
<li>Now, let’s drag <code>Raw Visit Counts</code> to the size card.</li>
</ol>
<p>Which type of store appears to have the most visitors?</p>
<ol start="4" type="1">
<li>Now, let’s add each store’s name to the tooltip. Drag <code>Location Name</code> to the Tooltip card.</li>
</ol>
<p><strong>You Do It:</strong> Make a new symbol map using each store’s latitude and longitude, and choosing what information you want to include as colors, size, and in the tooltip. What did you uncover?</p>
<p>Now, let’s see what happens if we select a different geographical field to make our map. Select the fields <code>City</code> and <code>Raw Visit Counts</code> and select the Symbol Map in the Show Me Menu. What is this map showing?</p>
<p>What if we change the aggregation of <code>Raw Visit Counts</code> to average instead of sum?</p>
</section>
<section id="creating-a-filled-map" class="level2">
<h2 class="anchored" data-anchor-id="creating-a-filled-map">2. Creating a Filled Map</h2>
<p>Let’s start this exercise with using the same cell phone data. Select the fields <code>Postal Code</code> and <code>Raw Visit Counts</code> and go to the Show Me Menu. Now you should see that you can use either a symbol or filled map. Let’s select the filled map.</p>
<p>What is this showing you? Are you able to map multiple store attributes using this feature? Do you think the filled map or symbol map are better for these data?</p>
<p>Connect to the dataset <code>rent_income_county.csv</code> and create one filled map that shows the median income in each county and one map that shows the median rent in each county.</p>
<p>Now, create a new calculated field called <code>income to rent ratio</code> that equal income divided by rent for each county. Plot this new field on a map and filter your data so that your map only includes Arizona (hint: Arizona’s FIPS code is 4). Which Arizona county has the highest income to rent ratio?</p>
</section>
<section id="customizing-your-map" class="level2">
<h2 class="anchored" data-anchor-id="customizing-your-map">3. Customizing Your Map</h2>
<p>Tableau includes a variety of features you can include in your maps if you desire. Right click on your map and select <code>Background Layers...</code></p>
<p>Click through some of the map layer options until you find a combination you like.</p>
<p>Now… let’s add some of Tableau’s more recent and VERY COOL integrated data sources. Select the drop down menu next to Data Layer and choose one. Change the geographic level this information is shown for.</p>
<p>Next let’s combine a symbol and filled map:</p>
<ol type="1">
<li><p>Go back to your Tableau window with the cell phone data analysis.</p></li>
<li><p>Create a new worksheet with a filled map showing total visit counts by postal code.</p></li>
<li><p>Command-click (or Control-click on Windows) the latitude measure on the rows shelf and drag it to the right (this copies the value)</p></li>
<li><p>Navigate to the Marks card for the second pane in your figure. Remove the Postal Code field from this map.</p></li>
<li><p>Select both the <code>Latitude</code> and <code>Longitude</code> fields and drag them to the details card.</p></li>
<li><p>Drag <code>Top Category</code> to the colors card. And drag <code>Distance from Home</code> (this is the median travel distance for customers in meters) to the Size card.</p></li>
<li><p>Right click the second <code>Latitude</code> field on the Rows shelf and select <code>Dual Axis</code>.</p></li>
</ol>
<p>Now you can add whatever custom formatting you desire!</p>
<p>What is this combined map showing?</p>
<!-- ### 7. Working with Individual-level data -->
<!-- Next let's connect to the dataset `acs_sample.csv`. These data come from the American Community Survey and include all Arizona households interviewed in 2021. I have included only a few of the many variables you can find in the ACS data. If you are interested in seeing the full variable options, I recommend looking at the [IPUMS website](https://www.ipums.org). -->
<!-- Create a filled map that shows average household income (in colors) by county. -->
<!-- Let's add a pie chart that shows the percentage of households that report receiving food stamps in each county. -->
<!-- 1. Drag `County Fip` over the map and drop it on `Add a Marks Layer` -->
<!-- 2. Navigate to the new Marks card for this second graph and select Pie Chart. -->
<!-- 3. Drag the `County Fip` field to the detail card. -->
<!-- 4. Drag the `Foodstmp` (this field is equal to 0 if the household did not receive Food Stamp benefits and is equal to 1 if they did) field to the color card and change it to a dimension.  -->
<!-- 5. Then drag the `Foodstmp` field to the angle card and change it to a count. -->

<!-- 6. Now create use a quick table calculation to change this to a percent of total, calculated over the Foodstmp field. -->
<!-- What is this figure showing? -->
<!-- Which county has the highest average income? -->
<!-- Which county has the highest food stamp usage? -->
<!-- Using individual-level (or in this case, household-level) data, you might also be interested in comparing outcomes across dimensions other than geography. For example, how might we show how income and rent compare for AZ households participating in Food Stamps versus for those who do not? -->
</section>
<section id="plotting-results-from-a-cluster-analysis" class="level2">
<h2 class="anchored" data-anchor-id="plotting-results-from-a-cluster-analysis">4. Plotting Results from a Cluster Analysis</h2>
<p>If you want to show results from your cluster analysis in Tableau, a simple way is to associate each cluster with a specific color. Let’s do this now.</p>
<ol type="1">
<li><p>Connect to your dataset with the results from your cluster analysis. I called this <code>analyzed_data.csv</code>.</p></li>
<li><p>Select <code>Latitude</code>, <code>Longitude</code>, and <code>Cluster</code> and select the Symbol Map from <code>Show Me</code>.</p></li>
<li><p>Recall you will need to change the <code>Latitude</code> and <code>Longitude</code> fields to Dimensions for this to display correctly.</p></li>
<li><p>Let’s also change <code>Cluster</code> to be associated with a color (rather than size) by dragging it to the <code>Color</code> card.</p></li>
<li><p>Finally, let’s change <code>Cluster</code> to a Dimension and tell Tableau that it is Discrete.</p></li>
<li><p>Let’s add some more detail to the tooltip. I would like to know the location name, top category, and cluster when I hover over each point on the map.</p></li>
</ol>
<div class="quarto-video ratio ratio-16x9"><iframe data-external="1" src="https://www.youtube.com/embed/lXloWsi7hZQ" title="" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>