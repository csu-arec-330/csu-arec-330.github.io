<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.280">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Week 3 Lab: R and Tableau Intro II</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="lab_00_week_03_files/libs/clipboard/clipboard.min.js"></script>
<script src="lab_00_week_03_files/libs/quarto-html/quarto.js"></script>
<script src="lab_00_week_03_files/libs/quarto-html/popper.min.js"></script>
<script src="lab_00_week_03_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="lab_00_week_03_files/libs/quarto-html/anchor.min.js"></script>
<link href="lab_00_week_03_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lab_00_week_03_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="lab_00_week_03_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="lab_00_week_03_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="lab_00_week_03_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#learning-objectives-tableau" id="toc-learning-objectives-tableau" class="nav-link active" data-scroll-target="#learning-objectives-tableau">Learning Objectives Tableau</a></li>
  <li><a href="#learning-objectives-r" id="toc-learning-objectives-r" class="nav-link" data-scroll-target="#learning-objectives-r">Learning Objectives R</a></li>
  <li><a href="#tableau-lab-overview" id="toc-tableau-lab-overview" class="nav-link" data-scroll-target="#tableau-lab-overview">Tableau Lab Overview</a>
  <ul class="collapse">
  <li><a href="#create-calculated-fields" id="toc-create-calculated-fields" class="nav-link" data-scroll-target="#create-calculated-fields">1. Create calculated fields</a></li>
  <li><a href="#organize-your-data-into-folders" id="toc-organize-your-data-into-folders" class="nav-link" data-scroll-target="#organize-your-data-into-folders">2. Organize your data into folders</a></li>
  <li><a href="#sorting-bar-charts" id="toc-sorting-bar-charts" class="nav-link" data-scroll-target="#sorting-bar-charts">3. Sorting bar charts</a></li>
  <li><a href="#using-the-marks-card-and-creating-groups" id="toc-using-the-marks-card-and-creating-groups" class="nav-link" data-scroll-target="#using-the-marks-card-and-creating-groups">4. Using the marks card and creating groups</a></li>
  <li><a href="#formatting-titles-axes-legends-etc." id="toc-formatting-titles-axes-legends-etc." class="nav-link" data-scroll-target="#formatting-titles-axes-legends-etc.">5. Formatting titles, axes, legends, etc.</a></li>
  <li><a href="#other-features-in-the-toolbar" id="toc-other-features-in-the-toolbar" class="nav-link" data-scroll-target="#other-features-in-the-toolbar">6. Other features in the toolbar</a></li>
  <li><a href="#using-the-filters-card" id="toc-using-the-filters-card" class="nav-link" data-scroll-target="#using-the-filters-card">7. Using the filters card</a></li>
  <li><a href="#stacking-bar-charts" id="toc-stacking-bar-charts" class="nav-link" data-scroll-target="#stacking-bar-charts">8. Stacking bar charts</a></li>
  <li><a href="#creating-bar-in-bar-charts" id="toc-creating-bar-in-bar-charts" class="nav-link" data-scroll-target="#creating-bar-in-bar-charts">9. Creating bar in bar charts</a></li>
  <li><a href="#basic-line-charts-and-datetime" id="toc-basic-line-charts-and-datetime" class="nav-link" data-scroll-target="#basic-line-charts-and-datetime">10. Basic line charts and datetime</a></li>
  <li><a href="#review" id="toc-review" class="nav-link" data-scroll-target="#review">11. Review</a></li>
  </ul></li>
  <li><a href="#r-dplyr-continued" id="toc-r-dplyr-continued" class="nav-link" data-scroll-target="#r-dplyr-continued">R: <code>dplyr</code> continued</a>
  <ul class="collapse">
  <li><a href="#summarize" id="toc-summarize" class="nav-link" data-scroll-target="#summarize">4. Summarize</a></li>
  <li><a href="#group-by" id="toc-group-by" class="nav-link" data-scroll-target="#group-by">Group by</a></li>
  <li><a href="#chaining-commands" id="toc-chaining-commands" class="nav-link" data-scroll-target="#chaining-commands">Chaining commands</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Week 3 Lab: R and Tableau Intro II</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><img src="includes/shopping.webp" class="img-fluid"></p>
<p>This Lab Contributes to Course Objectives 2, 3, 4, 5, 6, and 8</p>
<section id="learning-objectives-tableau" class="level2">
<h2 class="anchored" data-anchor-id="learning-objectives-tableau">Learning Objectives Tableau</h2>
<ul>
<li><p>Identify the function of items on the Tableau Toolbar</p></li>
<li><p>Create sorted, stacked, and bar in bar charts</p></li>
<li><p>Understand the functions of the <code>Marks</code> and <code>Filters</code> cards</p></li>
<li><p>Create calculated fields</p></li>
<li><p>Explain what it means to group your data</p></li>
<li><p>Apply formatting features to make your visualization more effective</p></li>
<li><p>Create line charts</p></li>
<li><p>Manipulate date-time fields</p></li>
</ul>
</section>
<section id="learning-objectives-r" class="level2">
<h2 class="anchored" data-anchor-id="learning-objectives-r">Learning Objectives R</h2>
<ul>
<li>Understand how to navigate directories on your file system</li>
</ul>
</section>
<section id="tableau-lab-overview" class="level2">
<h2 class="anchored" data-anchor-id="tableau-lab-overview">Tableau Lab Overview</h2>
<p>In week 2 of the course we covered the basic Tableau flow of analysis: Connect -&gt; Analyze -&gt; Share. Each of you followed this flow in problem set 2 to produce a simple data visualization using the grocery store spending dataset.</p>
<p>Today we are going to go in more detail in the analyze step of the process. We will learn to make a few new figures, we will learn more of the features of the Tableau analysis page, and we will discuss a few ways to change the formatting of your visualizations to make them more effective.</p>
<p>We will be using the same Supermarket Sales dataset, picking up where we left off with our analysis of product line ratings. We will be covering the following:</p>
<ol type="1">
<li><p>Creating calculated fields</p></li>
<li><p>Organizing fields in folders</p></li>
<li><p>More advanced bar charts: Sorting</p></li>
<li><p>Using the <code>Marks</code> card and creating groups</p></li>
<li><p>Formatting titles, axes, legends, etc.</p></li>
<li><p>Exploring the Tableau toolbar</p></li>
<li><p>Using the <code>Filters</code> card</p></li>
<li><p>More advanced bar charts: Stacking</p></li>
<li><p>More advanced bar charts: Bar in bar</p></li>
<li><p>Intro to line charts and manipulating dates</p></li>
</ol>
<section id="create-calculated-fields" class="level3">
<h3 class="anchored" data-anchor-id="create-calculated-fields">1. Create calculated fields</h3>
<p>In your last assignment you were asked to use R to calculate the total value of the sale using the <code>unit_price</code> and <code>quantity</code> columns. (And name the new column <code>subtotal</code>.)</p>
<p>We can do this sort of calculation in Tableau too!</p>
<p><img src="includes/newvar.png" class="img-fluid" style="width:60.0%"></p>
<p>Then select <code>Create Calculated Field...</code></p>
<p>Give your field a useful name (let’s use <code>subtotal</code>).</p>
<p>Drag the relevant variables into the box. Type the appropriate function (multiply). Click OK. And Voila.</p>
<p><strong>You do it:</strong> Validate that the value labeled <code>tax_5_percent</code> is indeed 5% of the <code>subtotal</code> by creating a new variable called <code>tax_verify</code>.</p>
<p><strong>You do it:</strong> Explore some other options for data manipulation by clicking the right triangle in the Create Calculated Field box. Try creating a new variable of your choosing.</p>
</section>
<section id="organize-your-data-into-folders" class="level3">
<h3 class="anchored" data-anchor-id="organize-your-data-into-folders">2. Organize your data into folders</h3>
<p>In your last assignment you were asked to use R to create a dataframe containing only a subset of your data, with the columns <code>city, product_line, unit_price, quantity, total, rating</code></p>
<p>In Tableau, one way to reduce the number of fields you see if by organizing your data into folders.</p>
<p>Try organizing your data into folders by:</p>
<ul>
<li><p>Selecting <code>Group by folder</code></p></li>
<li><p>Right click a field you want in the new folder</p></li>
<li><p>Click Folders -&gt; Create Folder…</p></li>
<li><p>Give your folder a useful name</p></li>
<li><p>Note that you can still combine data across different folders in your visualizations, you have just created a more organized data pane.</p></li>
</ul>
</section>
<section id="sorting-bar-charts" class="level3">
<h3 class="anchored" data-anchor-id="sorting-bar-charts">3. Sorting bar charts</h3>
<p>Let’s start off with our bar chart from last class where we looked at customer ratings by product line…</p>
<p>From our lecture on Wednesday, what are some ways we could improve this visualization to answer the question “Which product line has the lowest average customer rating?”</p>
<div class="notes">
<p>Title, adding color to highlight the top category, making font larger and easier to read, maybe changing axis range</p>
</div>
<p>What about <strong>sorting</strong>?</p>
<p>There are a two ways to sort bars on our chart:</p>
<ul>
<li><p>use the toolbar</p></li>
<li><p>use the icon next to the y-axis label</p></li>
</ul>
<p><strong>You do it:</strong> Sort the data so that the category with the highest rating is first and the category with the lowest rating is last.</p>
</section>
<section id="using-the-marks-card-and-creating-groups" class="level3">
<h3 class="anchored" data-anchor-id="using-the-marks-card-and-creating-groups">4. Using the marks card and creating groups</h3>
<p>What if we want to <strong>use color</strong> to highlight the top category?</p>
<p>There are a few ways to do this:</p>
<ul>
<li><p>Drag product line to <code>color</code> on the Marks card (then edit colors)</p></li>
<li><p>Right click the bar you want to stand out and click <code>Group</code> (then edit colors)</p></li>
</ul>
<p>What if we want to add <strong>labels</strong> with the value of the rating?</p>
<ul>
<li>Label -&gt; check <code>show mark labels</code></li>
</ul>
<p><strong>You do it:</strong> Show mark labels and click around with the other options on the label card. What formatting do you like best?</p>
<p>What if we want to change the <strong>width of our bars</strong>?</p>
<ul>
<li>Size -&gt; adjust!</li>
</ul>
<p>What if we want to add some extra info on the box that appears when we hover over a bar?</p>
<ul>
<li>Tooltip</li>
</ul>
<p><strong>You do it:</strong> Try adding some text to the tooltip. Click on Insert -&gt; what else can you add to the tooltip?</p>
</section>
<section id="formatting-titles-axes-legends-etc." class="level3">
<h3 class="anchored" data-anchor-id="formatting-titles-axes-legends-etc.">5. Formatting titles, axes, legends, etc.</h3>
<p>What if we want to <strong>adjust the scale</strong> of the y-axis so that differences across the bars are easier to see?</p>
<ul>
<li><p>Right click the y-axis</p></li>
<li><p>Click edit axis</p></li>
<li><p>Choose an appropriate range</p></li>
</ul>
<p>Now what happens if we compare these customer ratings across branches? Does the product line with the top ratings vary by store?</p>
<p><strong>You do it:</strong> Highlight the product line with the top rating at branch A - how does this rank in the other branches?</p>
<p><strong>You do it:</strong> Click on the different options in the legend - what happens?</p>
<p>What if we want to <strong>change the font size</strong> (or color, etc.) of the axis labels?</p>
<ul>
<li>Right click the axis you want to edit -&gt; click Format</li>
</ul>
<p>What if instead of having Branch/Product line at the top, we just rename A as Branch A, B as Branch B, etc.</p>
<ul>
<li><p>Right click Branch / Product line -&gt; Hide field labels</p></li>
<li><p>Right click branch -&gt; Edit Aliases…</p></li>
</ul>
<p><strong>You do it:</strong> Play with the formatting of your visualization until you are satisfied with its appearance.</p>
<p>What if we want to <strong>remove the legend</strong>?</p>
<p><strong>Adding a caption</strong> that describes details about your visualization. -&gt; Right click the visualization.</p>
<p><strong>Marking</strong> or <strong>annotating</strong> a single point. -&gt; Right click -&gt; Mark Label or Annotate</p>
</section>
<section id="other-features-in-the-toolbar" class="level3">
<h3 class="anchored" data-anchor-id="other-features-in-the-toolbar">6. Other features in the toolbar</h3>
<p>Let’s explore the Tableau toolbar… Hover over each icon in the toolbar… Click each icon in the toolbar!</p>
</section>
<section id="using-the-filters-card" class="level3">
<h3 class="anchored" data-anchor-id="using-the-filters-card">7. Using the filters card</h3>
<p>What if we want to recreate our analysis of ratings for female customers only?</p>
<p>Let’s use the toolbar to <strong>duplicate</strong> our worksheet.</p>
<p>Next, let’s add a filter for females:</p>
<ul>
<li><p>Drag the field <code>gender</code> to the <code>Filters</code> card</p></li>
<li><p>Select <code>Female</code></p></li>
</ul>
</section>
<section id="stacking-bar-charts" class="level3">
<h3 class="anchored" data-anchor-id="stacking-bar-charts">8. Stacking bar charts</h3>
<p>What if you want to see total sales split by gender and purchase category?</p>
<p><strong>You do it:</strong> Create a visualization (in a new sheet) that shows total sales by gender and product line.</p>
<p>Great, now what if we instead want to see this in terms of what percent of total sales within each category are from females vs.&nbsp;males?</p>
<p>Let’s try <strong>stacking</strong> our bars instead:</p>
<ul>
<li>Move gender from the rows shelf and drag it to the <code>Color</code> icon on the <code>Marks</code> card.</li>
</ul>
<p>What if we want to see the value of total sales for males and females?</p>
<ul>
<li>Label -&gt; Show Mark Labels</li>
</ul>
<p>What if we instead want to see the percent of total sales that are from males and females?</p>
<ul>
<li><p>Click the dropdown menu on SUM(Total)</p></li>
<li><p>Quick Table Calculation -&gt; Percent of Total</p></li>
</ul>
<p>Now what if we want to see the percent of total sales within each category that are from males and females?</p>
<ul>
<li><p>Create a 100% stacked bar chart</p></li>
<li><p>Click the dropdown menu on SUM(Total)</p></li>
<li><p>Compute Using -&gt; Gender</p></li>
</ul>
<p><strong>You do it:</strong> What do the other compute using options do?</p>
</section>
<section id="creating-bar-in-bar-charts" class="level3">
<h3 class="anchored" data-anchor-id="creating-bar-in-bar-charts">9. Creating bar in bar charts</h3>
<p>Another way to compare sales for males and females is to use a bar in bar chart. This will allow you to easily see whether total sales are higher for males or females.</p>
<ul>
<li><p>Let’s duplicate our 100% stacked bar chart</p></li>
<li><p>Drag gender to the <code>Size</code> icon in the <code>Marks</code> card</p></li>
<li><p>From the top menu, click Analysis -&gt; Stack Marks -&gt; Off</p></li>
</ul>
<p>What if we want to swap which gender is the wide bar?</p>
</section>
<section id="basic-line-charts-and-datetime" class="level3">
<h3 class="anchored" data-anchor-id="basic-line-charts-and-datetime">10. Basic line charts and datetime</h3>
<p>The second type of chart we will learn to create is a line chart.</p>
<p>Suppose we want to see trends in sales over time:</p>
<ul>
<li><p>Open a new worksheet</p></li>
<li><p>Drag <code>Total</code> to the rows shelf and <code>Date</code> to the columns shelf</p></li>
<li><p>Click the dropdown menu next to <code>Date</code></p></li>
<li><p>Click Week Number</p></li>
</ul>
<p><strong>You do it:</strong> Explore the other date display options. Which do you like best for this analysis?</p>
<p>What if we want to see trends in sales across months?</p>
<p>Let’s look at two options for doing this:</p>
<ol type="1">
<li><p>Side-by-side lines:</p>
<ul>
<li><p>With the <code>Date</code> aggregation set to MONTH in the columns shelf, double click the <code>Date</code> field.</p></li>
<li><p>Click the dropdown menu on the YEAR(Date) field on the columns shelf</p></li>
<li><p>Select Day</p></li>
</ul></li>
<li><p>Combined lines:</p>
<ul>
<li>Drag MONTH(Date) to the colors card</li>
</ul></li>
</ol>
<p>Let’s look at different line types. Click the new <code>Path</code> icon on the Marks card</p>
<p>Let’s add some trend lines. Analysis -&gt; Trend lines -&gt; Show Trend Lines</p>
<p>What are trend lines??</p>
</section>
<section id="review" class="level3">
<h3 class="anchored" data-anchor-id="review">11. Review</h3>
<ol type="1">
<li><p>Which payment type has the highest total spending?</p></li>
<li><p>Do more females or more males use this payment type?</p></li>
<li><p>Which payment type has seen the greatest increase in total spending over time?</p></li>
<li><p>For a challenge: Which payment type has seen the greatest increase in the <strong>number of customers using it</strong> over time?</p></li>
</ol>
</section>
</section>
<section id="r-dplyr-continued" class="level2">
<h2 class="anchored" data-anchor-id="r-dplyr-continued">R: <code>dplyr</code> continued</h2>
<p>Last week we introduced the five <code>dplyr</code> verbs generally used to manipulate data. We covered <code>mutate, filter, select,</code> and <code>arrange</code>.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a> We skipped over <code>summarize</code>. Today we will introduce <code>summarize</code> and a helpful companion function <code>group_by</code>. The <code>summarize</code> function is used to collapse multiple rows of data into a single row, by computing summary statistics for each group. This function can be used to summarize and aggregate data by computing statistics such as mean, sum, count, minimum, maximum, etc. for each group defined in the data.</p>
<p>Let’s return to our dataset <code>supermarket_sales.csv</code>. Use the function <code>read_csv()</code> to read <code>supermarket_sales.csv</code> into a dataframe called <code>supermarket_raw</code> (see <a href="../week_02/lab_00_week_02.html#read-the-data-into-r">lab 2</a>).</p>
<blockquote class="blockquote">
<p>Note that you can read in data and files from directories other than your working directory. You can include the directory in the file path.</p>
</blockquote>
<section id="summarize" class="level3">
<h3 class="anchored" data-anchor-id="summarize">4. Summarize</h3>
<p>We can use <code>summarize()</code> to calculate the total number of units sold in the dataset.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(supermarket_raw,<span class="at">quantity_summed=</span><span class="fu">sum</span>(quantity)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<blockquote class="blockquote">
<p>Notice that the command above does not assign the output to an object. It can be useful to quickly check the output of a command before assigning an object. Is the variable <code>quantity_summed</code> accessible to you? In other words, could you call that value within R and perform other operations on it? Can you modify that command to assign the output to an object called <code>total_sold</code>?</p>
</blockquote>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>total_sold <span class="ot">&lt;-</span> <span class="fu">summarize</span>(supermarket_raw,<span class="at">quantity_summed=</span><span class="fu">sum</span>(quantity)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p><strong>You do it</strong>: Try calculating the average of the <code>quantity</code> variable. In R, the function to calculate average is <code>mean()</code>. Now calculate the maximum <code>unit_price</code>. The function to calculate the maximum is <code>max()</code>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Mean quantity</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(supermarket_raw,<span class="at">quantity_mean=</span><span class="fu">mean</span>(quantity)) </span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Max price</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">summarize</span>(supermarket_raw,<span class="at">max_price=</span><span class="fu">max</span>(unit_price)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="group-by" class="level3">
<h3 class="anchored" data-anchor-id="group-by">Group by</h3>
<p>Often times, you need to perform some operation on a group of data. You can think about this as a sequence of operations: part 1) subset the group that you want to focus on, and part 2) perform the operation. For example, you might want to know the quantity of goods sold by branch.</p>
<p>Step 1: Filter the data in each branch (let’s just do branch A for example)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>branch_A_sales <span class="ot">&lt;-</span> <span class="fu">filter</span>(supermarket_raw,branch<span class="sc">==</span><span class="st">"A"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You should see a new dataframe called <code>branch_A_sales</code> with 340 observations. All of the variables from <code>supermarket_raw</code> are there including <code>quantity</code>.</p>
<p>Step 2: sum the quantity of goods sold</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>branch_A_total_quantity <span class="ot">&lt;-</span> <span class="fu">summarize</span>(branch_A_sales,<span class="at">total_quantity=</span><span class="fu">sum</span>(quantity))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>You try it</strong>: do the same thing for branch B and C.</p>
<p>This is pretty tedious. If operations in R or other programming languages seems tedious or repetitive, there are probably much better ways to do it. In this case, we can use a function <code>group_by()</code>. <code>group_by()</code> tells R to perform some operation like <code>sum</code> on each of the subgroups defined by another variable. Let’s sum the quantity by branch using <code>group_by()</code> and <code>summarize()</code>. We will do this in two steps:</p>
<p>Step 1: use <code>group_by()</code> to group the data by <code>branch</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">#This will create a signal for summarize but not perform any calculation.  </span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>super_sales_grouped_branch <span class="ot">&lt;-</span> <span class="fu">group_by</span>(supermarket_raw,branch)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Step 2: use <code>summarize()</code> to calculate the total quantity (by branch)</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">#This will create a signal for summarize but not perform any calculation.  </span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>total_quantity_by_branch <span class="ot">&lt;-</span> <span class="fu">summarize</span>(super_sales_grouped_branch,<span class="at">total_quantity=</span><span class="fu">sum</span>(quantity))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Notice that the result has the quantity sum for each branch. Do they match your manual calculations?</p>
<p><strong>You try it</strong>: Calculate the average <code>unit_price</code> for each <code>product_line</code> in the data.</p>
</section>
<section id="chaining-commands" class="level3">
<h3 class="anchored" data-anchor-id="chaining-commands">Chaining commands</h3>
<p>The script is a set of instructions for R that get executed in order. In some cases, you do not care about or need the intermediate output. The <code>group_by</code> and summarize sequence is a good example; you don’t need to store the dataframe <code>super_sales_grouped_branch</code>.</p>
</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p> See <a href="../week_02/lab_00_week_02.html#modifying-the-dataframe">lab 2</a> for reference.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>