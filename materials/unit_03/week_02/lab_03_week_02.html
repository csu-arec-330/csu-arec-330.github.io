<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.313">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Week 13 Lab: Introduction to Panel Data Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="lab_03_week_02_files/libs/clipboard/clipboard.min.js"></script>
<script src="lab_03_week_02_files/libs/quarto-html/quarto.js"></script>
<script src="lab_03_week_02_files/libs/quarto-html/popper.min.js"></script>
<script src="lab_03_week_02_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="lab_03_week_02_files/libs/quarto-html/anchor.min.js"></script>
<link href="lab_03_week_02_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="lab_03_week_02_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="lab_03_week_02_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="lab_03_week_02_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="lab_03_week_02_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#learning-objectives-tableau" id="toc-learning-objectives-tableau" class="nav-link active" data-scroll-target="#learning-objectives-tableau">Learning Objectives Tableau</a></li>
  <li><a href="#tableau" id="toc-tableau" class="nav-link" data-scroll-target="#tableau">Tableau</a>
  <ul class="collapse">
  <li><a href="#difference-in-differences" id="toc-difference-in-differences" class="nav-link" data-scroll-target="#difference-in-differences">Difference in differences</a>
  <ul class="collapse">
  <li><a href="#treatment-and-control-groups" id="toc-treatment-and-control-groups" class="nav-link" data-scroll-target="#treatment-and-control-groups">Treatment and Control Groups</a></li>
  <li><a href="#staggered-treatment-times" id="toc-staggered-treatment-times" class="nav-link" data-scroll-target="#staggered-treatment-times">Staggered Treatment Times</a></li>
  </ul></li>
  <li><a href="#fixed-effects-with-marginal-changes" id="toc-fixed-effects-with-marginal-changes" class="nav-link" data-scroll-target="#fixed-effects-with-marginal-changes">Fixed effects with marginal changes</a>
  <ul class="collapse">
  <li><a href="#maps-with-pages-visualizing-spatial-data-over-time" id="toc-maps-with-pages-visualizing-spatial-data-over-time" class="nav-link" data-scroll-target="#maps-with-pages-visualizing-spatial-data-over-time">Maps with Pages (visualizing spatial data over time)</a></li>
  <li><a href="#lines-with-distributions-visualizing-heterogeneity-over-time" id="toc-lines-with-distributions-visualizing-heterogeneity-over-time" class="nav-link" data-scroll-target="#lines-with-distributions-visualizing-heterogeneity-over-time">Lines with Distributions (visualizing heterogeneity over time)</a></li>
  </ul></li>
  <li><a href="#summary" id="toc-summary" class="nav-link" data-scroll-target="#summary">Summary</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Week 13 Lab: Introduction to Panel Data Analysis</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="includes/long_ai.jpeg" class="figure-img"></p>
</figure>
</div>
<div style="font-size: 1.5em">
<p>This Lab Contributes to Course Objectives: 1, 3, 4, 5, 7, 8</p>
</div>
<section id="learning-objectives-tableau" class="level2">
<h2 class="anchored" data-anchor-id="learning-objectives-tableau">Learning Objectives Tableau</h2>
<ul>
<li><p>Create visualizations for DiD analyses that account for:</p>
<ul>
<li><p>Treatment and control groups</p></li>
<li><p>Staggered treatment times</p></li>
</ul></li>
<li><p>Create visualizations for panel data analysis:</p>
<ul>
<li><p>Maps and pages</p></li>
<li><p>Visualizing temporal variation</p></li>
</ul></li>
</ul>
</section>
<section id="tableau" class="level1">
<h1>Tableau</h1>
<p>Panel data is a type of longitudinal data that involves the collection of observations on the same individuals or units over time. This makes panel data different from cross-sectional data, which involves the collection of observations on different individuals or units at a single point in time, and time series data, which involves the collection of observations on the same variable over time.</p>
<p>The objective of this lab is to show you how to create effective visualizations for your panel data analysis. We have touched on how to create all of these visualizations in prior labs, so today our focus will be less on the procedures for creating visualizations and more on ideas for tailoring these vizzes to panel data.</p>
<section id="difference-in-differences" class="level2">
<h2 class="anchored" data-anchor-id="difference-in-differences">Difference in differences</h2>
<p>The classic DiD visualization looks something like this:</p>
<p><img src="includes/did_figex1.png" class="img-fluid"></p>
<p>Or this:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="includes/did_figex2.png" class="figure-img"></p>
</figure>
</div>
<p>By now you are all well equiped to create these line graphs in Tableau, but there are two nuances to creating these that are worth discussion.</p>
<section id="treatment-and-control-groups" class="level3">
<h3 class="anchored" data-anchor-id="treatment-and-control-groups">Treatment and Control Groups</h3>
<p>Let’s connect to the minimum wage and employment dataset you used in lab last week – <code>min_wage_data.csv</code>. Notice that there is already a variable called <code>treat</code> and recall that this variable is equal to 1 if the county is in a state with a minimum wage increase and 0 otherwise.</p>
<ol type="1">
<li><p>Create a line graph that shows logged employment in treated and non-treated states. (Hint: use the <code>treat</code> field to assign colors to your lines.)</p></li>
<li><p>Are there any meaningful differences in average employment across treated and non-treated areas?</p></li>
</ol>
</section>
<section id="staggered-treatment-times" class="level3">
<h3 class="anchored" data-anchor-id="staggered-treatment-times">Staggered Treatment Times</h3>
<ol start="3" type="1">
<li><p>Now recall that different states implemented minimum wage increases at different points in time. What variable could we use to see if effects of the minimum wage increases are more apparent if we separate treated units by the timing or type of treatment? Create a line graph that shows logged employment by the treatment timing.</p></li>
<li><p>A downside to line graphs is that they don’t capture variation in employment well. Let’s try creating box and whisker plots so that this variation is more clear. Open a new sheet, select <code>year</code> and <code>Lemp</code> and go to <code>Show Me</code> -&gt; Box and whisker</p></li>
<li><p>Change <code>Lemp</code> to a <code>Dimension</code>, then drag <code>year</code> to columns shelf and assign it as <code>Discrete</code>.</p></li>
<li><p>Note that box and whisker plots show the median of the distribution, but we might also be interested in the means. How can you overlay this box and whisker plot with a line that shows the average value of <code>Lemp</code>?</p></li>
<li><p>Finally, let’s do this separately by treatment year. Drag <code>First.Treat</code> to the <code>Pages</code> card and change it to a dimension. Note that the title of your worksheet can now automatically change as you change pages. Let’s change the title to read <code>Distribution of Annual Employment For States with &lt;Page Name&gt;</code>, then let’s edit the aliases of the First.Treat variable to be more useful for this title. We can change 0 to say <code>No Minimum Wage Increase</code>, 2004 to say <code>Minimum Wage Increase in 2004</code>, etc.</p></li>
</ol>
</section>
</section>
<section id="fixed-effects-with-marginal-changes" class="level2">
<h2 class="anchored" data-anchor-id="fixed-effects-with-marginal-changes">Fixed effects with marginal changes</h2>
<p>This section will cover how to visualize changes in variables over space and time. We will use the fires and weather data you used in last week’s lab. You can download the data from <a href="https://colostate-my.sharepoint.com/:f:/g/personal/jbayham_colostate_edu/EgFfaomIJ8VOoPLiTz6YXfEBXQqoY1eiOuDmpPpur7f9Ow?e=zDMuWi">this folder</a>. The folder contains two files: 1) <code>fires_303.csv.gz</code> and 2) <code>weather_303.csv.gz</code>. <code>fires_303.csv.gz</code> contains three variables: 1) a unique county identifier, <code>county_fips</code>, 2) the observation date <code>measure_date</code>, and 3) the number of wildfire burning on that date in that county, <code>fires</code>. <code>weather_303.csv.gz</code> contains the same county and date information along with 1000-hour fuel moisture measured in percent from 1 to 40.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<section id="maps-with-pages-visualizing-spatial-data-over-time" class="level3">
<h3 class="anchored" data-anchor-id="maps-with-pages-visualizing-spatial-data-over-time">Maps with Pages (visualizing spatial data over time)</h3>
<p>Connect to the fires dataset and create a map that shows the total number of fires in each county. Now assign the <code>Year</code> variable as your pages and give your map a useful title (that changes with the year).</p>
<p>Note that you might want to play with different maximum values of your fires variable so that differences across time are more apparent. Try this now by going to Color -&gt; Edit Colors -&gt; Advanced -&gt; and choose a reasonable top copding value.</p>
</section>
<section id="lines-with-distributions-visualizing-heterogeneity-over-time" class="level3">
<h3 class="anchored" data-anchor-id="lines-with-distributions-visualizing-heterogeneity-over-time">Lines with Distributions (visualizing heterogeneity over time)</h3>
<p>Create a line graph that shows average fires across years in the sample.</p>
<p>Next, create a new variable that counts the total number of (logged) fires in a county each year by creating a new calculated field called <code>Total Fires</code> using the equation <code>{FIXED [year],[county_fips]: SUM(LN([Fires]))}</code>.</p>
<p>Create a circle plot of this variable by dragging it to the rows shelf to the right of avg. fires. Drag the total fires varaible again to the <code>Size</code> icon, and change it to <code>count</code>. You should now have circles that reflect the number of counties with the indicated number of fires. You may want to filter on this variable to remove the large number of zeros.</p>
</section>
</section>
<section id="summary" class="level2">
<h2 class="anchored" data-anchor-id="summary">Summary</h2>
<p>This lab covered different ways of visualizing panel data. There are of course many other avenues you can take to visualize your data and I encourage you to think outside the box for your final project. Dream of your ideal visualization and I can probably help you put it together!</p>
</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>1000-Hour Fuel Moisture (1000-hr FM) represents the modeled moisture content in dead fuels in the 3 to 8 inch diameter class and the layer of the forest floor about four inches below the surface. The 1000-hr FM value is based on a running 7-day computed average using length of day, daily temperature and relative humidity extremes (maximum and minimum values) and the 24-hour precipitation duration values. Values can range from 1 to 40 percent (<a href="https://gacc.nifc.gov/nrcc/predictive/fuels_fire-danger/psa_component_glossary.htm">source</a>).<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>